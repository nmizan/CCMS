SELECT 'User: ' + USERS_ID + ', Functional Group ' 'LOG_MESSAGE',INPUT_BY,INPUT_DATETIME,INPUT_FROM,AUTH_BY,AUTH_DATETIME,AUTH_FROM ,
'USERS FUNCTIONAL GROUP' AS 'ASSET',
'TypeOfAccess'= 
CASE WHEN [STATUS]='L' AND MOD_NO=1 THEN 'ADD'
WHEN [STATUS]='L' AND MOD_NO>1 THEN 'MODIFY'
WHEN [STATUS]='D' AND MOD_NO>1 THEN 'DELETE'
ELSE ''
END
FROM USERS_FG 
UNION
SELECT 'User: ' + USERS_ID + ', Functional Group '  'LOG_MESSAGE',INPUT_BY,INPUT_DATETIME,INPUT_FROM,AUTH_BY,AUTH_DATETIME,AUTH_FROM ,
'USERS FUNCTIONAL GROUP' AS 'ASSET',
'TypeOfAccess'= 
CASE WHEN [STATUS]='O' AND MOD_NO=1 THEN 'ADD'
WHEN [STATUS]='O' AND MOD_NO>1 THEN 'MODIFY'
WHEN [STATUS]='U' AND MOD_NO=1 THEN 'ADD'
WHEN [STATUS]='U' AND MOD_NO>1 THEN 'MODIFY'
WHEN [STATUS]='D' AND MOD_NO>1 THEN 'DELETE'
ELSE ''
END
FROM USERS_FG_HIST




