

ALTER VIEW [dbo].[V_DD_FUNDING]
as
(
	SELECT DD.D_CODE AS DEPOSIT_NO, DD.DD_NO, DD.AMOUNT,DD.DD_DATE,
		b.BANK_NAME as DRAWEE_BANK, br.BRANCH_NAME AS DRAWEE_BRANCH ,cc.CLIENT_CODE
		FROM DD 
		INNER JOIN BANK b
		ON b.BANK_CODE=dd.DRAWER_BANKCODE
		INNER JOIN BRANCH br
		ON br.BANK_CODE=dd.DRAWER_BANKCODE AND br.BRANCH_CODE=dd.DRAWER_BRANCHCODE
		AND br.LOCATION_CODE=dd.DRAWER_LOCATION
		INNER JOIN NCOLLECTION nc
		ON DD.D_CODE+RIGHT(('000'+CONVERT(VARCHAR,DD.SLNO)),3) =nc.DDREFNO
		INNER JOIN CCHECK cc
		ON nc.NONZONE_REF=cc.NONZONE_REF
		WHERE DD.[STATUS]='L'
		GROUP BY DD.D_CODE, DD.DD_NO, DD.AMOUNT,DD.DD_DATE,
		b.BANK_NAME, br.BRANCH_NAME,cc.CLIENT_CODE
	
)

GO


